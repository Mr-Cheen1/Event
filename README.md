<p align="center">
  <a href="https://github.com/Mr-Cheen1/Event/actions/workflows/lint.yml"><img src="https://github.com/Mr-Cheen1/Event/actions/workflows/lint.yml/badge.svg" alt="Lint Status"/></a>
  <a href="https://github.com/Mr-Cheen1/Event/actions/workflows/test.yml"><img src="https://github.com/Mr-Cheen1/Event/actions/workflows/test.yml/badge.svg" alt="Test Status"/></a>
  <a href="https://github.com/Mr-Cheen1/Event/actions/workflows/build.yml"><img src="https://github.com/Mr-Cheen1/Event/actions/workflows/build.yml/badge.svg" alt="Build Status"/></a>
</p>
# Telegram-бот для напоминания о событиях

Этот проект представляет собой Telegram-бота, который отправляет напоминания о предстоящих событиях, таких как дни рождения и годовщины.

## Особенности

- Отправка уведомлений о событиях в заданное время
- Поддержка различных часовых поясов
- Напоминания за 2 дня до события и в день события
- Конфигурация через JSON-файлы

## Требования

- Go 1.22.6 или выше
- Telegram Bot API Token

## Установка

1. Клонируйте репозиторий:
   
   ```
   git clone https://github.com/Mr-Cheen1/Event.git
   cd название-репозитория
   ```

2. Установите зависимости:
   
   ```
   go mod download
   ```

3. Создайте файл `.env` в корневой директории проекта и добавьте следующие переменные:
   
   ```
   BOT_TOKEN=ваш_токен_бота
   CHAT_ID=идентификатор_чата
   ```

4. Настройте `config.json` и `events.json` файлы под свои нужды.

## Использование

Запустите бота командой:

```
go run main.go
```
## Конфигурация

### config.json

Этот файл содержит настройки времени отправки уведомлений и часового пояса:

{
"notification_time": "13:42",
"timezone": "Europe/Samara"
}

### events.json

Этот файл содержит список событий:

[
{
"date": "03.09",
"event": "День рождения Дмитрия"
},
{
"date": "02.09",
"event": "Годовщина свадьбы Анны и Вадима"
}
]

## Тестирование

Для запуска тестов используйте команду:

```
go test ./...
```

## Принцип работы приложения:

1. Инициализация:
- Приложение начинает работу с загрузки переменных окружения из файла .env, где хранятся токен бота и ID чата (см. main.go).
- Затем загружается конфигурация из файла config.json, которая содержит время отправки уведомлений и часовой пояс (см. config/config.go).
- Список событий загружается из файла events.json (см. events/events.go).

2. Настройка бота:
- Создается экземпляр Telegram бота с использованием токена из переменных окружения (см. main.go).

3. Основной цикл:
- Приложение входит в бесконечный цикл, где оно постоянно проверяет текущее время (см. main.go).
- Когда наступает время отправки уведомлений (указанное в config.json), запускается проверка событий.

4. Проверка событий:
- Функция CheckEvents в events/events.go проходит по всем событиям из events.json.
- Для каждого события вычисляется количество дней до его наступления.
- Если событие происходит сегодня или через 2 дня, формируется соответствующее сообщение.

5. Отправка уведомлений:
- Если для события нужно отправить уведомление, оно отправляется в указанный Telegram чат с помощью бота (см. events/events.go).

6. Ожидание следующей проверки:
- После проверки всех событий и отправки уведомлений, приложение ждет 24 часа перед следующей проверкой (см. main.go).

7. Обработка ошибок:
- На всех этапах работы приложения происходит логирование ошибок для облегчения отладки (см. все файлы .go).

8. Тестирование:
- Приложение включает модульные тесты для проверки корректности загрузки конфигурации и обработки событий (см. config/config_test.go и events/events_test.go).

## Структура проекта:

- event/ - Директория с проектом.
  - .github/ - Директория с конфигурациями для GitHub Actions.
    - workflows/ - Директория с файлами определения рабочих процессов для GitHub Actions.
     - lint.yml - Файл с настройками для линтинга кода.
     - test.yml - Файл с настройками для запуска тестов.
     - build.yml - Файл с настройками для сборки проекта.
  - .env - Содержит переменные окружения, такие как токен бота и ID чата.D чата)
  - go.mod - Файл, описывающий зависимости проекта и версию Go.
  - go.sum - Файл с хешами зависимостей для обеспечения воспроизводимости сборки.
  - main.go - Основной файл приложения, содержащий функцию main() и основной цикл работы бота.
  - README.md - Файл с описанием проекта, инструкциями по установке и использованию.
  - config/ - Директория с конфигурационным кодом
    - config.go - Содержит код для загрузки и обработки конфигурационного файла.
    - config_test.go - Тесты для проверки корректности загрузки конфигурации.
  - events/ - Директория с кодом для работы с событиями
    - events.go - Содержит код для загрузки событий и проверки наступления дат.
    - events_test.go - Тесты для проверки корректности работы с событиями.
  - config.json - Конфигурационный файл в формате JSON, содержащий время отправки уведомлений и часовой пояс.
  - events.json - Файл в формате JSON со списком событий, включая даты и описания.